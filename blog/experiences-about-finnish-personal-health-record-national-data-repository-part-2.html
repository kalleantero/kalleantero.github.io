<!DOCTYPE html>
<html>

<!-- Mirrored from kalle-blog.azurewebsites.net/blog/experiences-about-finnish-personal-health-record-national-data-repository-part-2 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 24 Apr 2021 13:42:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">

    
    <title>Experiences about Finnish Personal Health Record national data repository (part 2) - Blog by Kalle Marjokorpi</title>
    <meta name="description" content="This blog post handles how to create a new application client to the PHR Sandbox environment via self-service portal.">
    <meta name="author" content="Kalle Marjokorpi">


    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/vendor.css">
    <link rel="stylesheet" href="../css/main.css">

    <script src="../js/modernizr.js"></script>
    <script src="../js/pace.min.js"></script>

    <script type="text/javascript">!function(T,l,y){var S=T.location,u="script",k="instrumentationKey",D="ingestionendpoint",C="disableExceptionTracking",E="ai.device.",I="toLowerCase",b="crossOrigin",w="POST",e="appInsightsSDK",t=y.name||"appInsights";(y.name||T[e])&&(T[e]=t);var n=T[t]||function(d){var g=!1,f=!1,m={initialize:!0,queue:[],sv:"4",version:2,config:d};function v(e,t){var n={},a="Browser";return n[E+"id"]=a[I](),n[E+"type"]=a,n["ai.operation.name"]=S&&S.pathname||"_unknown_",n["ai.internal.sdkVersion"]="javascript:snippet_"+(m.sv||m.version),{time:function(){var e=new Date;function t(e){var t=""+e;return 1===t.length&&(t="0"+t),t}return e.getUTCFullYear()+"-"+t(1+e.getUTCMonth())+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((e.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),iKey:e,name:"Microsoft.ApplicationInsights."+e.replace(/-/g,"")+"."+t,sampleRate:100,tags:n,data:{baseData:{ver:2}}}}var h=d.url||y.src;if(h){function a(e){var t,n,a,i,r,o,s,c,p,l,u;g=!0,m.queue=[],f||(f=!0,t=h,s=function(){var e={},t=d.connectionString;if(t)for(var n=t.split(";"),a=0;a<n.length;a++){var i=n[a].split("=");2===i.length&&(e[i[0][I]()]=i[1])}if(!e[D]){var r=e.endpointsuffix,o=r?e.location:null;e[D]="https://"+(o?o+".":"")+"dc."+(r||"services.visualstudio.com")}return e}(),c=s[k]||d[k]||"",p=s[D],l=p?p+"/v2/track":config.endpointUrl,(u=[]).push((n="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",a=t,i=l,(o=(r=v(c,"Exception")).data).baseType="ExceptionData",o.baseData.exceptions=[{typeName:"SDKLoadFailed",message:n.replace(/\./g,"-"),hasFullStack:!1,stack:n+"\nSnippet failed to load ["+a+"] -- Telemetry is disabled\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\nHost: "+(S&&S.pathname||"_unknown_")+"\nEndpoint: "+i,parsedStack:[]}],r)),u.push(function(e,t,n,a){var i=v(c,"Message"),r=i.data;r.baseType="MessageData";var o=r.baseData;return o.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+n+")").replace(/\"/g,"")+'"',o.properties={endpoint:a},i}(0,0,t,l)),function(e,t){if(JSON){var n=T.fetch;if(n&&!y.useXhr)n(t,{method:w,body:JSON.stringify(e),mode:"cors"});else if(XMLHttpRequest){var a=new XMLHttpRequest;a.open(w,t),a.setRequestHeader("Content-type","application/json"),a.send(JSON.stringify(e))}}}(u,l))}function i(e,t){f||setTimeout(function(){!t&&m.core||a()},500)}var e=function(){var n=l.createElement(u);n.src=h;var e=y[b];return!e&&""!==e||"undefined"==n[b]||(n[b]=e),n.onload=i,n.onerror=a,n.onreadystatechange=function(e,t){"loaded"!==n.readyState&&"complete"!==n.readyState||i(0,t)},n}();y.ld<0?l.getElementsByTagName("head")[0].appendChild(e):setTimeout(function(){l.getElementsByTagName(u)[0].parentNode.appendChild(e)},y.ld||0)}try{m.cookie=l.cookie}catch(p){}function t(e){for(;e.length;)!function(t){m[t]=function(){var e=arguments;g||m.queue.push(function(){m[t].apply(m,e)})}}(e.pop())}var n="track",r="TrackPage",o="TrackEvent";t([n+"Event",n+"PageView",n+"Exception",n+"Trace",n+"DependencyData",n+"Metric",n+"PageViewPerformance","start"+r,"stop"+r,"start"+o,"stop"+o,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),m.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4};var s=(d.extensionConfig||{}).ApplicationInsightsAnalytics||{};if(!0!==d[C]&&!0!==s[C]){method="onerror",t(["_"+method]);var c=T[method];T[method]=function(e,t,n,a,i){var r=c&&c(e,t,n,a,i);return!0!==r&&m["_"+method]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},d.autoExceptionInstrumented=!0}return m}(y.cfg);(T[t]=n).queue&&0===n.queue.length&&n.trackPageView({})}(window,document,{
src: "https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",
cfg: { 
    connectionString: 'InstrumentationKey=ebdfbae8-ec79-4f33-b5c3-ad05861ae331;IngestionEndpoint=https://westeurope-5.in.applicationinsights.azure.com/'
}});
    </script>
</head>
<body id="top">
   
    <!-- header
    ================================================== -->

    
        <!-- header
   ================================================== -->

<header class="s-header">

    <div class="header-logo">
        <a class="site-logo" href="../index.html"><img src="../images/logo2.png" alt="Homepage"></a>
    </div>

    

    <nav class="header-nav-wrap">

        <ul class="header-nav">


            <li class="current"><a id="top-navigation-link-root" href="../index.html" title="">Home</a></li>

                <li id="top-navigation-link-about" class="smoothscroll"><a href="../about.html" title="">About me</a></li>

        </ul>
    </nav> <!-- end main-nav-wrap -->




    <a class="header-menu-toggle" href="#0"><span>Menu</span></a>

</header> <!-- end s-header -->


    

    

<!-- content
   ================================================== -->


    <article class="blog-single">

        <!-- page header/blog hero
    ================================================== -->

        
        <div class="page-header page-header--single page-hero" style=background-image:url(https://cdn.buttercms.com/cVrfyFXeS36Jhm8cUNdN)>

            <div class="row page-header__content narrow">
                <article class="col-full">
                    <div class="page-header__info">
                        <div class="page-header__cat">
                                <a id="post-category-omatietovaranto" href="category/omatietovaranto.html">Omatietovaranto</a>
                                <a id="post-category-phr" href="category/phr.html">PHR</a>
                        </div>
                    </div>
                    <h1 class="page-header__title">
                        <a href="#0" title="">
                            Experiences about Finnish Personal Health Record data repository (part 2)
                        </a>
                    </h1>
                    <ul class="page-header__meta">
                        <li class="date">
07.10.2018 06:48                        </li>
                        <li class="author">
                            By
                            <span>Kalle Marjokorpi</span>
                        </li>
                    </ul>

                </article>
                
            </div>

        </div> <!-- end page-header -->

        <div class="row blog-content">
            <div class="col-full blog-content__main">

                <p><p>This blog post handles how to create a new application client to the PHR Sandbox environment via self-service portal.</p>
<h2>Create an admin user</h2>
<p>First you have to create an admin user to self-service portal. Admin user can be created via this <a href="https://fhirsandbox2-auth.kanta.fi/phr-authserver-sandbox/registeruser">site</a>. Admin user can create new application clients to the PHR Sandbox environment.</p>
<p><img src="https://cdn.buttercms.com/NMv8BjM1SxWV4ijIT26H" alt="" /></p>
<h2>Create a new client</h2>
<p>Log in the <a href="https://fhirsandbox2-auth.kanta.fi/phr-authserver-sandbox/">self-service portal</a> using admin user credential which was created in the previous phase. In the main page click "Self-service client registration" from the left navigation.</p>
<p><img src="https://cdn.buttercms.com/ByUD2KPqQx2nP0VyrOsj" alt="" /></p>
<p></p>
<p>Next you should give basic information about your client app. Fill at least Client name and redirect URI(s). Redirect URI will be destination where client is redirected after authorization. I'm testing my application only in my machine so my redirect URL is pointing to the localhost.&nbsp;</p>
<p><img src="https://cdn.buttercms.com/GqHWGPWQUOGpbB34V7c4" alt="" /></p>
<p>In the Access tab you can configure allowed scopes.&nbsp;<span>OAuth 2.0 scopes limits access to the resources which are granted to an access token.&nbsp;In this example I'm concentrating to handle only Observation types so I choose Observation read and write scopes. Observations can be like steps, activity, weight, blood pressure etc.</span></p>
<p><img src="https://cdn.buttercms.com/JG0gLfnCR6aXzxFVYpm7" alt="" /></p>
<p>Grant types basically describes methods for a client application to acquire an access token. Access token represents a user's permission for the client to access data. More information about Grant types you can find from <a href="https://oauth.net/2/grant-types/ ">here</a> and <a href="https://alexbilbie.com/guide-to-oauth-2-grants/">here</a>.</p>
<p>This application will use authorization code as a grant type. Basically after authentication and when user has approved that that specific client application can use user's PHR data, authorization code is sent to the client application. Client application will be found from the URL which was declared in the client settings (Redirect URI) in the self-service portal. Client application receives the authorization code and uses it the fetch user's access token from the Token endpoint of the Sandbox environment.</p>
<p><img src="https://cdn.buttercms.com/fRN2hoJrQGWzeovCGzlp" alt="" /></p>
<p>In the credentials tab you can determine token endpoint authentication methods. I left these default settings active in this sample application.</p>
<p><img src="https://cdn.buttercms.com/DbrnVzZyR8S73cO4RC6q" alt="" /></p>
<p>Now the most important settings are declared and you can hit the create button. After creation you will get the Client ID, Client secret and Registration access token of your client. Remember to save these information because currently Sandbox self-service portal has a bug which prevents you to access these information later!</p>
<p><img src="https://cdn.buttercms.com/9n9xdXYhQqSGrtvHtiMD" alt="" /></p>
<h2>Editing existing client</h2>
<p>Self-service portal has a functionality to edit existing client information (click Self-service client registration from the navigation). You should give ClientId and Registration Access Token to edit client.</p>
<p><img src="https://cdn.buttercms.com/LCJmhLkLRwelkYQbVFvQ" alt="" /></p>
<p>Like said earlier currently there is a bug which prevents you the edit the client. If you want to edit your client please contact Kela. Sandbox administrator user in Kela can change settings manually from the request. Kela is investigating this issue.</p>
<p><img src="https://cdn.buttercms.com/MB0VFEudSnSggUGTzqcm" alt="" /></p>
<p>Update 27.10.2018 - Client editing is now working via self service portal.</p>
<p>Next blog post will handle technical implementation how to implement PHR Sandbox client application.</p></p>

                <div class="blog-content__pagenav">
                    <div class="blog-content__nav">
                            <div class="blog-content__prev">
                                <a id="post-previous-omakannan-omatietovaranto" href="omakannan-omatietovaranto.html" rel="prev">
                                    <span>Previous Post</span>
                                    Experiences about Finnish Personal Health Record data repository (part 1)
                                </a>
                            </div>
                            <div class="blog-content__next">
                                <a id="post-next-experiences-about-finnish-personal-health-record-national-data-repository-part-3" href="experiences-about-finnish-personal-health-record-national-data-repository-part-3.html" rel="next">
                                    <span>Next Post</span>
                                    Experiences about Finnish Personal Health Record data repository (part 3)
                                </a>
                            </div>
                        </div>


                    <div class="blog-content__all">
                        <a href="../index.html" class="btn btn--primary">
                            View All Post
                        </a>
                    </div>
                </div>

            </div><!-- end blog-content__main -->
        </div> <!-- end blog-content -->

    </article>



    
        

<!-- footer
    ================================================== -->
<footer>
    <div class="row">
        <div class="col-full">

            <div class="footer-logo">
                <a class="footer-site-logo" href="#0"><img src="../images/name.png" alt="Homepage"></a>
            </div>

            <ul class="footer-social">
                <li>
                    <a href="https://www.twitter.com/kmarjok">
                        <i class="im im-twitter" aria-hidden="true"></i>
                        <span>Twitter</span>
                    </a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/kallemarjokorpi">
                        <i class="im im-linkedin" aria-hidden="true"></i>
                        <span>Linkedin</span>
                    </a>
                </li>
                <li>
                    <a href="https://github.com/kalleantero">
                        <i class="im im-github" aria-hidden="true"></i>
                        <span>Github</span>
                    </a>
                </li>
            </ul>

        </div>
    </div>

    <div class="row footer-bottom">

        <div class="col-twelve">
            <div class="copyright">
                <span>Copyright Kalle Marjokorpi 2021</span>
                <span>Design by <a href="http://www.styleshout.com/">styleshout</a></span>
                <span>Content management by <a href="http://www.buttercms.com/">Headless ButterCMS</a></span>

            </div>

        </div>

    </div> <!-- end footer-bottom -->

</footer> <!-- end footer -->
    


    <div id="preloader">
        <div id="loader"></div>
    </div>

    <!-- Java Script
     ================================================== -->
    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/plugins.js"></script>
    <script src="../js/main.min.js"></script>
    
    
    <!-- Cloudflare Web Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "cac9fd24c1c04b6d9984ea31685b0414"}'></script><!-- End Cloudflare Web Analytics -->

</body>

<!-- Mirrored from kalle-blog.azurewebsites.net/blog/experiences-about-finnish-personal-health-record-national-data-repository-part-2 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 24 Apr 2021 13:42:34 GMT -->
</html>
